{
  "$schema": "https://opencode.ai/config.json",

  // ─── Model ────────────────────────────────────────────────────────
  // Primary model for Otto. Sonnet 4.5 is the sweet spot for an
  // always-on assistant: capable enough, fast, cheaper than Opus.
  "model": "openai/gpt-5.3-codex",

  // Cheap model for auto-generated session titles
  "small_model": "openai/gpt-5.3-codex",

  // ─── Plugins ──────────────────────────────────────────────────────
  // agent-memory: Letta-style persistent memory blocks (persona, human, project)
  //   - Stores markdown files in .opencode/memory/ (project-level)
  //   - Injects memory into system prompt automatically
  //   - Gives Otto 3 tools: memory_list, memory_set, memory_replace
  "plugin": [
    "opencode-agent-memory"
  ],

  // ─── Custom Agent: assistant ──────────────────────────────────────
  // Otto's primary persona. The system prompt is loaded from a
  // separate markdown file for easier editing.
  "agent": {
    "assistant": {
      "model": "openai/gpt-5.3-codex",
      "description": "Otto — your 24/7 personal assistant",
      "mode": "primary",
      "color": "#4ECDC4",
      "prompt": "agents/assistant.md",
      "temperature": 0.3,
      "steps": 25,
      "permission": {
        "bash": "allow",
        "edit": "allow",
        "read": "allow",
        "glob": "allow",
        "grep": "allow",
        "list": "allow",
        "webfetch": "allow",
        "websearch": "allow",
        "todoread": "allow",
        "todowrite": "allow",
        // Allow Otto to read/write outside the project dir
        // (needed for ~/.otto/data/, Obsidian vault, etc.)
        "external_directory": "allow",
        // Allow memory plugin tools without confirmation
        "memory_*": "allow"
      }
    },
    // Disable the default build/plan agents — Otto isn't a coding assistant
    "build": {
      "disable": true
    },
    "plan": {
      "disable": true
    }
  },

  // Default to the assistant agent
  "default_agent": "assistant",

  // ─── Instructions ─────────────────────────────────────────────────
  // Additional context files that get loaded into every session.
  // The memory plugin handles its own injection, but these are
  // static references Otto should always know about.
  "instructions": [
    "AGENTS.md"
  ],

  // ─── Permissions (global defaults) ────────────────────────────────
  // Since Otto runs headless on the Orin via cron and `opencode run`,
  // it can't ask for confirmation. Allow everything by default.
  "permission": "allow",

  // ─── MCP Servers ──────────────────────────────────────────────────
  // Google-first setup:
  // - Gmail via google-workspace MCP
  // - Calendar via google-calendar MCP
  "mcp": {
    "gmail": {
      "type": "local",
      "command": ["npx", "-y", "@dguido/google-workspace-mcp"],
      "environment": {
        "GOOGLE_CLIENT_ID": "{env:GOOGLE_CLIENT_ID}",
        "GOOGLE_CLIENT_SECRET": "{env:GOOGLE_CLIENT_SECRET}",
        "GOOGLE_WORKSPACE_SERVICES": "gmail"
      },
      "enabled": true
    },
    "gcal": {
      "type": "local",
      "command": ["npx", "-y", "@cocal/google-calendar-mcp"],
      "environment": {
        "GOOGLE_OAUTH_CREDENTIALS": "{env:GOOGLE_OAUTH_CREDENTIALS}",
        "ENABLED_TOOLS": "list-calendars,list-events,search-events,get-event,get-freebusy,get-current-time,create-event,update-event,delete-event,respond-to-event"
      },
      "enabled": true
    }
  },

  // ─── Misc ─────────────────────────────────────────────────────────
  "share": "disabled",
  "autoupdate": false,
  "snapshot": false
}
